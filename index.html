<!DOCTYPE html>
<!-- saved from url=(0130)https://gensparkpublicblob.blob.core.windows.net/user-upload-image/page/tooluse_3QGC-fwlRlq4jouwOZ0tKg/seiko_direct_logo_form.html -->
<html lang="ja"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>都合の悪い日 提出フォーム</title>
    <link href="./1913_files/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f5f5f5 0%, #e8e8e8 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #c41e3a 0%, #a01729 100%);
            padding: 30px;
            text-align: center;
            color: white;
            opacity: 0.9;
        }

        .logo {
            height: 80px;
            margin-bottom: 20px;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
        }

        .form-content {
            padding: 40px;
        }

        h1 {
            font-size: 28px;
            margin-bottom: 10px;
            text-align: center;
            color: #333;
            font-weight: 600;
        }

        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 16px;
        }

        .form-group {
            margin-bottom: 25px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
            font-size: 16px;
        }

        input[type="text"], input[type="date"], select, textarea {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: #fafafa;
        }

        input[type="text"]:focus, input[type="date"]:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #c41e3a;
            background: white;
            box-shadow: 0 0 0 3px rgba(196, 30, 58, 0.1);
        }

        .schedule-section {
            margin-top: 40px;
        }

        .section-title {
            font-size: 22px;
            margin-bottom: 20px;
            color: #333;
            font-weight: 600;
            text-align: center;
        }

        .add-schedule-btn {
            background: linear-gradient(135deg, #c41e3a 0%, #a01729 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            margin-bottom: 20px;
            display: block;
            margin-left: auto;
            margin-right: auto;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(196, 30, 58, 0.3);
        }

        .add-schedule-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(196, 30, 58, 0.4);
        }

        .schedule-item {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
            position: relative;
            transition: all 0.3s ease;
        }

        .schedule-item:hover {
            border-color: #c41e3a;
            box-shadow: 0 4px 16px rgba(196, 30, 58, 0.1);
        }

        .schedule-header {
            display: flex;
            justify-content: between;
            align-items: center;
            margin-bottom: 20px;
        }

        .schedule-title {
            font-size: 18px;
            font-weight: 600;
            color: #333;
        }

        .delete-btn {
            background: #dc3545;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            position: absolute;
            top: 15px;
            right: 15px;
            transition: background 0.3s ease;
        }

        .delete-btn:hover {
            background: #c82333;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }

        .radio-group {
            display: flex;
            gap: 20px;
            margin-bottom: 15px;
        }

        .radio-option {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .radio-option input[type="radio"] {
            width: auto;
            margin: 0;
        }

        .time-selection {
            display: none;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }

        .time-selection.active {
            display: grid;
        }

        .submit-btn {
            background: linear-gradient(135deg, #c41e3a 0%, #a01729 100%);
            color: white;
            border: none;
            padding: 16px 40px;
            border-radius: 8px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            display: block;
            margin: 40px auto 0;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(196, 30, 58, 0.3);
        }

        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(196, 30, 58, 0.4);
        }

        .submit-btn:disabled {
            background: #6c757d;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 8px;
            }

            .form-content {
                padding: 20px;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .time-selection {
                grid-template-columns: 1fr;
            }

            .radio-group {
                flex-direction: column;
                gap: 10px;
            }
        }

        .loading {
            display: none;
            text-align: center;
            margin-top: 20px;
        }

        .success-message {
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            display: none;
        }

        .error-message {
            background: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            display: none;
        }
    </style>
<style>
    .genspark-notice-dialog {
      display: flex;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      z-index: 10001;
      align-items: center;
      justify-content: center;
    }

    .genspark-notice-content {
      background-color: white;
      border-radius: 8px;
      max-width: 600px;
      width: 90%;
      box-sizing: border-box;
      padding: 10px 30px 30px 30px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      font-size: 16px;
    }

    .genspark-notice-title {
      color: #000;
      font-family: Arial;
      font-size: 20px;
      font-style: normal;
      font-weight: 700;
      line-height: 150%; 
    }

    .genspark-notice-list {
      margin: 24px 0;
      
      color: #606366;
      font-family: Arial;
      font-size: 14px;
      font-style: normal;
      font-weight: 400;
      line-height: 150%;
      padding-left: 12px;
    }

    .genspark-notice-list li {
      margin-bottom: 12px;
      list-style-type: disc;
    }

    .genspark-notice-list li a {
      color: #606366;
      text-decoration: underline;
    }

    .genspark-notice-checkbox {
      display: flex;
      align-items: center;
      margin-top: 20px;
      gap: 10px;

      color: #232425;

      font-family: Arial;
      font-size: 14px;
      font-style: normal;
      font-weight: 400;
      line-height: normal;
    }

    .genspark-notice-actions {
      display: flex;
      justify-content: center;
      margin-top: 20px;
    }
      
    .genspark-notice-ok {
      color: #232425;

      text-align: center;
      font-family: Arial;
      font-size: 16px;
      font-style: normal;
      font-weight: 700;
      line-height: 150%; 

      cursor: pointer;
      display: flex;
      height: 40px;
      padding: 6px 14px;
      justify-content: center;
      align-items: center;
      gap: 10px;
      align-self: stretch;
      border-radius: 8px;
      border: 1px solid #000;
      box-sizing: border-box;
      width: 100%;
    }
  </style></head>
<body>
    <div class="container">
        <div class="header">
            <img src="./1913_files/logo.png" alt="Logo" class="logo">
        </div>
        
        <div class="form-content">
            <h1>都合の悪い日 提出フォーム</h1>
            <p class="subtitle">複数の日程を一度に報告できます。各日程ごとに備考を入力してください。</p>
            
            <form id="scheduleForm">
                <div class="form-group">
                    <label for="name">提出者名</label>
                    <input type="text" id="name" name="name" placeholder="お名前を入力してください" required="">
                </div>
                
                <div class="schedule-section">
                    <h2 class="section-title">都合の悪い日程</h2>
                    <button type="button" class="add-schedule-btn" onclick="addSchedule()">
                        <i class="fas fa-plus"></i> 日程を追加
                    </button>
                    
                    <div id="scheduleContainer">
                        <!-- 日程項目がここに追加されます -->
                    <div class="schedule-item" id="schedule-1">
                <div class="schedule-header">
                    <h3 class="schedule-title">日程 1</h3>
                    <button type="button" class="delete-btn" onclick="removeSchedule(1)">
                        <i class="fas fa-trash"></i> 削除
                    </button>
                </div>
                
                <div class="form-group">
                    <label for="date-1">日付</label>
                    <input type="date" id="date-1" name="date-1" required="">
                </div>
                
                <div class="form-group">
                    <label>タイプ</label>
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" id="allday-1" name="type-1" value="終日不可" checked="" onchange="toggleTimeSelection(1)">
                            <label for="allday-1">終日不可</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="timerange-1" name="type-1" value="時間帯指定" onchange="toggleTimeSelection(1)">
                            <label for="timerange-1">時間帯指定</label>
                        </div>
                    </div>
                </div>
                
                <div class="time-selection" id="timeSelection-1">
                    <div class="form-group">
                        <label for="startTime-1">開始時刻</label>
                        <select id="startTime-1" name="startTime-1">
                            <option value="08:00">08:00</option><option value="08:30">08:30</option><option value="09:00">09:00</option><option value="09:30">09:30</option><option value="10:00">10:00</option><option value="10:30">10:30</option><option value="11:00">11:00</option><option value="11:30">11:30</option><option value="12:00">12:00</option><option value="12:30">12:30</option><option value="13:00">13:00</option><option value="13:30">13:30</option><option value="14:00">14:00</option><option value="14:30">14:30</option><option value="15:00">15:00</option><option value="15:30">15:30</option><option value="16:00">16:00</option><option value="16:30">16:30</option><option value="17:00">17:00</option><option value="17:30">17:30</option><option value="18:00">18:00</option><option value="18:30">18:30</option><option value="19:00">19:00</option><option value="19:30">19:30</option><option value="20:00">20:00</option><option value="20:30">20:30</option><option value="21:00">21:00</option><option value="21:30">21:30</option><option value="22:00">22:00</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="endTime-1">終了時刻</label>
                        <select id="endTime-1" name="endTime-1">
                            <option value="08:00">08:00</option><option value="08:30">08:30</option><option value="09:00">09:00</option><option value="09:30">09:30</option><option value="10:00">10:00</option><option value="10:30">10:30</option><option value="11:00">11:00</option><option value="11:30">11:30</option><option value="12:00">12:00</option><option value="12:30">12:30</option><option value="13:00">13:00</option><option value="13:30">13:30</option><option value="14:00">14:00</option><option value="14:30">14:30</option><option value="15:00">15:00</option><option value="15:30">15:30</option><option value="16:00">16:00</option><option value="16:30">16:30</option><option value="17:00">17:00</option><option value="17:30">17:30</option><option value="18:00">18:00</option><option value="18:30">18:30</option><option value="19:00">19:00</option><option value="19:30">19:30</option><option value="20:00">20:00</option><option value="20:30">20:30</option><option value="21:00">21:00</option><option value="21:30">21:30</option><option value="22:00">22:00</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="remarks-1">備考（任意）</label>
                    <textarea id="remarks-1" name="remarks-1" rows="3" placeholder="この日程に関する補足事項があれば入力してください"></textarea>
                </div>
            </div></div>
                </div>
                
                <button type="submit" class="submit-btn" id="submitBtn">
                    <i class="fas fa-paper-plane"></i> 送信
                </button>
                
                <div class="loading" id="loading">
                    <i class="fas fa-spinner fa-spin"></i> 送信中...
                </div>
                
                <div class="success-message" id="successMessage">
                    送信が完了しました！
                </div>
                
                <div class="error-message" id="errorMessage">
                    送信に失敗しました。再度お試しください。
                </div>
            </form>
        </div>
    </div>

    <script>
        let scheduleCount = 0;

        // 時間オプションを生成
        function generateTimeOptions() {
            const options = [];
            for (let hour = 8; hour <= 21; hour++) {
                for (let minute = 0; minute < 60; minute += 30) {
                    const timeString = `${hour.toString().padStart(2, '0')}:${minute.toString().padStart(2, '0')}`;
                    options.push(`<option value="${timeString}">${timeString}</option>`);
                }
            }
            // 終了時刻用に22:00を追加
            options.push(`<option value="22:00">22:00</option>`);
            return options.join('');
        }

        function addSchedule() {
            scheduleCount++;
            const container = document.getElementById('scheduleContainer');
            const scheduleItem = document.createElement('div');
            scheduleItem.className = 'schedule-item';
            scheduleItem.id = `schedule-${scheduleCount}`;
            
            scheduleItem.innerHTML = `
                <div class="schedule-header">
                    <h3 class="schedule-title">日程 ${scheduleCount}</h3>
                    <button type="button" class="delete-btn" onclick="removeSchedule(${scheduleCount})">
                        <i class="fas fa-trash"></i> 削除
                    </button>
                </div>
                
                <div class="form-group">
                    <label for="date-${scheduleCount}">日付</label>
                    <input type="date" id="date-${scheduleCount}" name="date-${scheduleCount}" required>
                </div>
                
                <div class="form-group">
                    <label>タイプ</label>
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" id="allday-${scheduleCount}" name="type-${scheduleCount}" value="終日不可" checked onchange="toggleTimeSelection(${scheduleCount})">
                            <label for="allday-${scheduleCount}">終日不可</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="timerange-${scheduleCount}" name="type-${scheduleCount}" value="時間帯指定" onchange="toggleTimeSelection(${scheduleCount})">
                            <label for="timerange-${scheduleCount}">時間帯指定</label>
                        </div>
                    </div>
                </div>
                
                <div class="time-selection" id="timeSelection-${scheduleCount}">
                    <div class="form-group">
                        <label for="startTime-${scheduleCount}">開始時刻</label>
                        <select id="startTime-${scheduleCount}" name="startTime-${scheduleCount}">
                            ${generateTimeOptions()}
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="endTime-${scheduleCount}">終了時刻</label>
                        <select id="endTime-${scheduleCount}" name="endTime-${scheduleCount}">
                            ${generateTimeOptions()}
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="remarks-${scheduleCount}">備考（任意）</label>
                    <textarea id="remarks-${scheduleCount}" name="remarks-${scheduleCount}" rows="3" placeholder="この日程に関する補足事項があれば入力してください"></textarea>
                </div>
            `;
            
            container.appendChild(scheduleItem);
            
            // 終了時刻のデフォルト値を開始時刻より後に設定
            const startTime = document.getElementById(`startTime-${scheduleCount}`);
            const endTime = document.getElementById(`endTime-${scheduleCount}`);
            
            startTime.addEventListener('change', function() {
                const startIndex = startTime.selectedIndex;
                if (endTime.selectedIndex <= startIndex) {
                    endTime.selectedIndex = Math.min(startIndex + 1, endTime.options.length - 1);
                }
            });
            
            // デフォルト値設定
            startTime.value = '09:00';
            endTime.value = '10:00';
        }

        function removeSchedule(id) {
            const scheduleItem = document.getElementById(`schedule-${id}`);
            scheduleItem.remove();
        }

        function toggleTimeSelection(id) {
            const timeRange = document.getElementById(`timerange-${id}`);
            const timeSelection = document.getElementById(`timeSelection-${id}`);
            
            if (timeRange.checked) {
                timeSelection.classList.add('active');
            } else {
                timeSelection.classList.remove('active');
            }
        }

        // 初期状態で1つのスケジュールを追加
        addSchedule();

        // フォーム送信処理
        document.getElementById('scheduleForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const submitBtn = document.getElementById('submitBtn');
            const loading = document.getElementById('loading');
            const successMessage = document.getElementById('successMessage');
            const errorMessage = document.getElementById('errorMessage');
            
            // UI状態をリセット
            successMessage.style.display = 'none';
            errorMessage.style.display = 'none';
            submitBtn.disabled = true;
            loading.style.display = 'block';
            
            const name = document.getElementById('name').value;
            const schedules = [];
            
            // 各スケジュール項目を収集
            const scheduleItems = document.querySelectorAll('.schedule-item');
            scheduleItems.forEach((item) => {
                const id = item.id.split('-')[1];
                const date = document.getElementById(`date-${id}`).value;
                const type = document.querySelector(`input[name="type-${id}"]:checked`).value;
                const remarks = document.getElementById(`remarks-${id}`).value;
                
                let timeDetail = '';
                if (type === '時間帯指定') {
                    const startTime = document.getElementById(`startTime-${id}`).value;
                    const endTime = document.getElementById(`endTime-${id}`).value;
                    timeDetail = `${startTime} 〜 ${endTime}`;
                } else {
                    timeDetail = '終日不可';
                }
                
                schedules.push({
                    date: date,
                    type: type,
                    timeDetail: timeDetail,
                    remarks: remarks
                });
            });
            
            // 各スケジュールを個別に送信
            try {
                for (const schedule of schedules) {
                    const formData = new FormData();
                    formData.append('name', name);
                    formData.append('date', schedule.date);
                    formData.append('type', schedule.type);
                    formData.append('timeDetail', schedule.timeDetail);
                    formData.append('remarks', schedule.remarks);
                    
                    const response = await fetch('https://script.google.com/macros/s/AKfycbzbSiSIQwGvs01hEYc-DWr9PhgTT2vJfDT559EvgblEEbBqwfzPk2MB2OAPnxelOUY/exec', {
                        method: 'POST',
                        body: formData
                    });
                    
                    if (!response.ok) {
                        throw new Error('送信エラー');
                    }
                }
                
                // 成功時の処理
                successMessage.style.display = 'block';
                document.getElementById('scheduleForm').reset();
                
                // スケジュール項目をリセット
                document.getElementById('scheduleContainer').innerHTML = '';
                scheduleCount = 0;
                addSchedule();
                
            } catch (error) {
                console.error('送信エラー:', error);
                errorMessage.style.display = 'block';
            } finally {
                submitBtn.disabled = false;
                loading.style.display = 'none';
            }
        });
    </script>


    <script id="html_badge_script1">
        window.__genspark_remove_badge_link = "https://www.genspark.ai/api/html_badge/" +
            "remove_badge?token=To%2FBnjzloZ3UfQdcSaYfDpFPpcpI6DqrEhDzjg60yTncYou6ROqHpS0mkFdarFIxLgEBWA54sijLLdiqqd7xX0PDg4VOvmxQayjgP8iD89lxJ%2BX05pqcM4bmAHDdlkX0TATpbI%2Bg6iehS3rYxNGcZyrbWVGsUIAZ%2BGZd4ClwgzdUHlcKdHMCzwrwya5EJtD%2BMl7MYTnT2%2BaUeeyHhBDFmx6IsFUVkFGQfsrDZ%2Fl4XFlngLa352Pe2Z%2FdxMQnH6xBZuP8VaRDKH2AXh442MyyZpYKfO7c4%2F5f2gvF3LvseBm2thdQNJucYlWHTMaIzho69jCeWEwuaqEuAVog7ai5CVUFBSTtccLu0Wk%2B66VddZDIJKMoIFdZOChODC9Q%2Fx4UYHAkrLK5n6Qvtb4oiy%2BpWoc4Un78tiQ1rrWC6fEmzMxSlPLYCmnq%2BPNuZJHOgaJ1R115lW8%2BosSc%2BYavsr3mEmc4rx1170z8CU5aLFuF4f3h%2FlKEU2KwnaDIoGoKteGCLGNpqYy06nkoRnTgZX9r5Q%3D%3D";
        window.__genspark_locale = "ja-JP";
        window.__genspark_token = "To/BnjzloZ3UfQdcSaYfDpFPpcpI6DqrEhDzjg60yTncYou6ROqHpS0mkFdarFIxLgEBWA54sijLLdiqqd7xX0PDg4VOvmxQayjgP8iD89lxJ+X05pqcM4bmAHDdlkX0TATpbI+g6iehS3rYxNGcZyrbWVGsUIAZ+GZd4ClwgzdUHlcKdHMCzwrwya5EJtD+Ml7MYTnT2+aUeeyHhBDFmx6IsFUVkFGQfsrDZ/l4XFlngLa352Pe2Z/dxMQnH6xBZuP8VaRDKH2AXh442MyyZpYKfO7c4/5f2gvF3LvseBm2thdQNJucYlWHTMaIzho69jCeWEwuaqEuAVog7ai5CVUFBSTtccLu0Wk+66VddZDIJKMoIFdZOChODC9Q/x4UYHAkrLK5n6Qvtb4oiy+pWoc4Un78tiQ1rrWC6fEmzMxSlPLYCmnq+PNuZJHOgaJ1R115lW8+osSc+Yavsr3mEmc4rx1170z8CU5aLFuF4f3h/lKEU2KwnaDIoGoKteGCLGNpqYy06nkoRnTgZX9r5Q==";
    </script>
    
    <script id="html_notice_dialog_script" src="./1913_files/notice_dialog.js"></script>
    </body></html>