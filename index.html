<!DOCTYPE html>
<!-- saved from url=(0052)https://www.genspark.ai/api/page_private?id=jpmdjxrl -->
<html lang="ja"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>都合の悪い日 提出フォーム（日付別備考対応版）</title>
    <link href="./都合の悪い日 提出フォーム（日付別備考対応版）_files/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="./都合の悪い日 提出フォーム（日付別備考対応版）_files/all.min.css">
    <style>
        .schedule-item {
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            transition: all 0.3s ease;
        }
        .schedule-item:hover {
            border-color: #3b82f6;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.15);
        }
        .time-inputs {
            display: none;
        }
        .time-inputs.active {
            display: flex;
        }
        .loading {
            display: none;
        }
        .success-message {
            display: none;
        }
        .error-message {
            display: none;
        }
    </style>
<style>
    .genspark-notice-dialog {
      display: flex;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      z-index: 10001;
      align-items: center;
      justify-content: center;
    }

    .genspark-notice-content {
      background-color: white;
      border-radius: 8px;
      max-width: 600px;
      width: 90%;
      box-sizing: border-box;
      padding: 10px 30px 30px 30px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      font-size: 16px;
    }

    .genspark-notice-title {
      color: #000;
      font-family: Arial;
      font-size: 20px;
      font-style: normal;
      font-weight: 700;
      line-height: 150%; 
    }

    .genspark-notice-list {
      margin: 24px 0;
      
      color: #606366;
      font-family: Arial;
      font-size: 14px;
      font-style: normal;
      font-weight: 400;
      line-height: 150%;
      padding-left: 12px;
    }

    .genspark-notice-list li {
      margin-bottom: 12px;
      list-style-type: disc;
    }

    .genspark-notice-list li a {
      color: #606366;
      text-decoration: underline;
    }

    .genspark-notice-checkbox {
      display: flex;
      align-items: center;
      margin-top: 20px;
      gap: 10px;

      color: #232425;

      font-family: Arial;
      font-size: 14px;
      font-style: normal;
      font-weight: 400;
      line-height: normal;
    }

    .genspark-notice-actions {
      display: flex;
      justify-content: center;
      margin-top: 20px;
    }
      
    .genspark-notice-ok {
      color: #232425;

      text-align: center;
      font-family: Arial;
      font-size: 16px;
      font-style: normal;
      font-weight: 700;
      line-height: 150%; 

      cursor: pointer;
      display: flex;
      height: 40px;
      padding: 6px 14px;
      justify-content: center;
      align-items: center;
      gap: 10px;
      align-self: stretch;
      border-radius: 8px;
      border: 1px solid #000;
      box-sizing: border-box;
      width: 100%;
    }
  </style></head>
<body class="bg-gray-50 min-h-screen py-8">
    <div class="max-w-4xl mx-auto px-4">
        <div class="bg-white rounded-lg shadow-lg p-8">
            <div class="text-center mb-8">
                <h1 class="text-3xl font-bold text-gray-800 mb-4">
                    <i class="fas fa-calendar-times text-red-500 mr-3"></i>
                    都合の悪い日 提出フォーム
                </h1>
                <p class="text-gray-600">複数の日程を一度に報告できます。各日程ごとに備考を入力してください。</p>
            </div>

            <form id="scheduleForm" class="space-y-6">
                <!-- 提出者名 -->
                <div class="bg-blue-50 p-6 rounded-lg">
                    <label for="submitterName" class="block text-lg font-semibold text-gray-700 mb-3">
                        <i class="fas fa-user text-blue-500 mr-2"></i>提出者名
                    </label>
                    <input type="text" id="submitterName" name="submitterName" required="" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-lg" placeholder="お名前を入力してください">
                </div>

                <!-- 日程入力エリア -->
                <div class="bg-gray-50 p-6 rounded-lg">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-xl font-semibold text-gray-800">
                            <i class="fas fa-calendar-alt text-green-500 mr-2"></i>都合の悪い日程
                        </h2>
                        <button type="button" id="addScheduleBtn" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg transition duration-200 flex items-center">
                            <i class="fas fa-plus mr-2"></i>日程を追加
                        </button>
                    </div>
                    
                    <div id="scheduleContainer">
                        <!-- 初期の日程入力項目 -->
                        <div class="schedule-item bg-white p-6 mb-4" data-index="0">
                            <div class="flex justify-between items-center mb-4">
                                <h3 class="text-lg font-medium text-gray-700">日程 1</h3>
                                <button type="button" class="remove-schedule bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded text-sm" style="display: none;">
                                    <i class="fas fa-trash mr-1"></i>削除
                                </button>
                            </div>
                            
                            <!-- 日付選択 -->
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 mb-2">日付</label>
                                <input type="date" name="date_0" required="" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>

                            <!-- タイプ選択 -->
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 mb-2">タイプ</label>
                                <div class="flex space-x-4">
                                    <label class="flex items-center">
                                        <input type="radio" name="type_0" value="終日不可" checked="" class="mr-2 text-blue-500" onchange="toggleTimeInputs(0)">
                                        <span class="text-gray-700">終日不可</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="radio" name="type_0" value="時間帯指定" class="mr-2 text-blue-500" onchange="toggleTimeInputs(0)">
                                        <span class="text-gray-700">時間帯指定</span>
                                    </label>
                                </div>
                            </div>

                            <!-- 時間帯選択 -->
                            <div class="time-inputs mb-4" id="timeInputs_0">
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">開始時刻</label>
                                        <select name="startTime_0" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                                            <option value="08:00">08:00</option>
                                            <option value="08:30">08:30</option>
                                            <option value="09:00">09:00</option>
                                            <option value="09:30">09:30</option>
                                            <option value="10:00">10:00</option>
                                            <option value="10:30">10:30</option>
                                            <option value="11:00">11:00</option>
                                            <option value="11:30">11:30</option>
                                            <option value="12:00">12:00</option>
                                            <option value="12:30">12:30</option>
                                            <option value="13:00">13:00</option>
                                            <option value="13:30">13:30</option>
                                            <option value="14:00">14:00</option>
                                            <option value="14:30">14:30</option>
                                            <option value="15:00">15:00</option>
                                            <option value="15:30">15:30</option>
                                            <option value="16:00">16:00</option>
                                            <option value="16:30">16:30</option>
                                            <option value="17:00">17:00</option>
                                            <option value="17:30">17:30</option>
                                            <option value="18:00">18:00</option>
                                            <option value="18:30">18:30</option>
                                            <option value="19:00">19:00</option>
                                            <option value="19:30">19:30</option>
                                            <option value="20:00">20:00</option>
                                            <option value="20:30">20:30</option>
                                            <option value="21:00">21:00</option>
                                            <option value="21:30">21:30</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">終了時刻</label>
                                        <select name="endTime_0" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                                            <option value="08:30">08:30</option>
                                            <option value="09:00">09:00</option>
                                            <option value="09:30">09:30</option>
                                            <option value="10:00">10:00</option>
                                            <option value="10:30">10:30</option>
                                            <option value="11:00">11:00</option>
                                            <option value="11:30">11:30</option>
                                            <option value="12:00">12:00</option>
                                            <option value="12:30">12:30</option>
                                            <option value="13:00">13:00</option>
                                            <option value="13:30">13:30</option>
                                            <option value="14:00">14:00</option>
                                            <option value="14:30">14:30</option>
                                            <option value="15:00">15:00</option>
                                            <option value="15:30">15:30</option>
                                            <option value="16:00">16:00</option>
                                            <option value="16:30">16:30</option>
                                            <option value="17:00">17:00</option>
                                            <option value="17:30" selected="">17:30</option>
                                            <option value="18:00">18:00</option>
                                            <option value="18:30">18:30</option>
                                            <option value="19:00">19:00</option>
                                            <option value="19:30">19:30</option>
                                            <option value="20:00">20:00</option>
                                            <option value="20:30">20:30</option>
                                            <option value="21:00">21:00</option>
                                            <option value="21:30">21:30</option>
                                            <option value="22:00">22:00</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <!-- 備考 -->
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 mb-2">備考（任意）</label>
                                <textarea name="remarks_0" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="この日程に関する補足事項があれば入力してください"></textarea>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 送信ボタン -->
                <div class="text-center pt-6">
                    <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold px-8 py-4 rounded-lg text-lg transition duration-200 flex items-center justify-center mx-auto">
                        <i class="fas fa-paper-plane mr-2"></i>送信
                    </button>
                </div>

                <!-- ローディング表示 -->
                <div class="loading text-center py-4">
                    <i class="fas fa-spinner fa-spin text-2xl text-blue-500"></i>
                    <p class="text-gray-600 mt-2">送信中...</p>
                </div>

                <!-- 成功メッセージ -->
                <div class="success-message bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded-lg text-center">
                    <i class="fas fa-check-circle mr-2"></i>
                    送信が完了しました！
                </div>

                <!-- エラーメッセージ -->
                <div class="error-message bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg text-center">
                    <i class="fas fa-exclamation-triangle mr-2"></i>
                    <span id="errorText">送信に失敗しました。再度お試しください。</span>
                </div>
            </form>
        </div>
    </div>

    <script>
        let scheduleCount = 1;
        const maxSchedules = 10;

        // 日程追加機能
        document.getElementById('addScheduleBtn').addEventListener('click', function() {
            if (scheduleCount >= maxSchedules) {
                alert('最大10件まで追加できます。');
                return;
            }

            const container = document.getElementById('scheduleContainer');
            const newSchedule = createScheduleItem(scheduleCount);
            container.appendChild(newSchedule);
            scheduleCount++;
            updateRemoveButtons();
        });

        // 日程項目作成
        function createScheduleItem(index) {
            const div = document.createElement('div');
            div.className = 'schedule-item bg-white p-6 mb-4';
            div.setAttribute('data-index', index);
            
            div.innerHTML = `
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-lg font-medium text-gray-700">日程 ${index + 1}</h3>
                    <button type="button" class="remove-schedule bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded text-sm">
                        <i class="fas fa-trash mr-1"></i>削除
                    </button>
                </div>
                
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">日付</label>
                    <input 
                        type="date" 
                        name="date_${index}" 
                        required 
                        class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                    >
                </div>

                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">タイプ</label>
                    <div class="flex space-x-4">
                        <label class="flex items-center">
                            <input 
                                type="radio" 
                                name="type_${index}" 
                                value="終日不可" 
                                checked 
                                class="mr-2 text-blue-500"
                                onchange="toggleTimeInputs(${index})"
                            >
                            <span class="text-gray-700">終日不可</span>
                        </label>
                        <label class="flex items-center">
                            <input 
                                type="radio" 
                                name="type_${index}" 
                                value="時間帯指定" 
                                class="mr-2 text-blue-500"
                                onchange="toggleTimeInputs(${index})"
                            >
                            <span class="text-gray-700">時間帯指定</span>
                        </label>
                    </div>
                </div>

                <div class="time-inputs mb-4" id="timeInputs_${index}">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">開始時刻</label>
                            <select name="startTime_${index}" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                                ${generateTimeOptions('start')}
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">終了時刻</label>
                            <select name="endTime_${index}" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                                ${generateTimeOptions('end')}
                            </select>
                        </div>
                    </div>
                </div>

                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">備考（任意）</label>
                    <textarea 
                        name="remarks_${index}" 
                        rows="3" 
                        class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                        placeholder="この日程に関する補足事項があれば入力してください"
                    ></textarea>
                </div>
            `;

            // 削除ボタンのイベントリスナー追加
            div.querySelector('.remove-schedule').addEventListener('click', function() {
                div.remove();
                scheduleCount--;
                updateScheduleNumbers();
                updateRemoveButtons();
            });

            return div;
        }

        // 時間オプション生成
        function generateTimeOptions(type) {
            const times = [];
            const startHour = 8;
            const endHour = type === 'start' ? 21 : 22;
            const startMinute = type === 'start' ? 0 : 30;
            
            for (let hour = startHour; hour <= endHour; hour++) {
                const minutes = hour === startHour && type === 'end' ? [30] : hour === endHour ? [0] : [0, 30];
                minutes.forEach(minute => {
                    if (hour === endHour && minute > 0 && type === 'start') return;
                    const timeStr = `${hour.toString().padStart(2, '0')}:${minute.toString().padStart(2, '0')}`;
                    const selected = (type === 'end' && timeStr === '17:30') ? 'selected' : '';
                    times.push(`<option value="${timeStr}" ${selected}>${timeStr}</option>`);
                });
            }
            return times.join('');
        }

        // 時間入力表示切替
        function toggleTimeInputs(index) {
            const timeType = document.querySelector(`input[name="type_${index}"]:checked`).value;
            const timeInputs = document.getElementById(`timeInputs_${index}`);
            
            if (timeType === '時間帯指定') {
                timeInputs.classList.add('active');
            } else {
                timeInputs.classList.remove('active');
            }
        }

        // 削除ボタン表示更新
        function updateRemoveButtons() {
            const scheduleItems = document.querySelectorAll('.schedule-item');
            scheduleItems.forEach((item, index) => {
                const removeBtn = item.querySelector('.remove-schedule');
                if (scheduleItems.length > 1) {
                    removeBtn.style.display = 'inline-block';
                } else {
                    removeBtn.style.display = 'none';
                }
            });
        }

        // 日程番号更新
        function updateScheduleNumbers() {
            const scheduleItems = document.querySelectorAll('.schedule-item');
            scheduleItems.forEach((item, index) => {
                const title = item.querySelector('h3');
                title.textContent = `日程 ${index + 1}`;
            });
        }

        // フォーム送信処理
        document.getElementById('scheduleForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            const submitterName = formData.get('submitterName');
            
            // 各日程のデータを収集
            const schedules = [];
            const scheduleItems = document.querySelectorAll('.schedule-item');
            
            scheduleItems.forEach((item, index) => {
                const date = formData.get(`date_${index}`);
                const type = formData.get(`type_${index}`);
                const startTime = formData.get(`startTime_${index}`);
                const endTime = formData.get(`endTime_${index}`);
                const remarks = formData.get(`remarks_${index}`) || '';
                
                if (date && type) {
                    let timeDetail = '';
                    if (type === '時間帯指定' && startTime && endTime) {
                        timeDetail = `${startTime} 〜 ${endTime}`;
                    } else if (type === '終日不可') {
                        timeDetail = '終日不可';
                    }
                    
                    schedules.push({
                        name: submitterName,
                        date: date,
                        type: type,
                        timeDetail: timeDetail,
                        remarks: remarks
                    });
                }
            });

            if (schedules.length === 0) {
                alert('少なくとも1つの日程を入力してください。');
                return;
            }

            // UI更新
            document.querySelector('button[type="submit"]').style.display = 'none';
            document.querySelector('.loading').style.display = 'block';
            document.querySelector('.success-message').style.display = 'none';
            document.querySelector('.error-message').style.display = 'none';

            try {
                // 各日程を個別に送信
                for (const schedule of schedules) {
                    const params = new URLSearchParams();
                    params.append('name', schedule.name);
                    params.append('date', schedule.date);
                    params.append('type', schedule.type);
                    params.append('timeDetail', schedule.timeDetail);
                    params.append('remarks', schedule.remarks);

                    const response = await fetch('https://script.google.com/macros/s/AKfycbwtJNbq_-9TprdZc98M_KTZq4CPnuE1wY3uhkrZi0y5Rzw7egN-UhxJi80ws_cfffq2_A/exec', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/x-www-form-urlencoded',
                        },
                        body: params.toString()
                    });

                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }

                    // 短い間隔を置いて次の送信へ
                    await new Promise(resolve => setTimeout(resolve, 500));
                }

                // 成功処理
                document.querySelector('.loading').style.display = 'none';
                document.querySelector('.success-message').style.display = 'block';
                
                // フォームをリセット
                setTimeout(() => {
                    location.reload();
                }, 2000);

            } catch (error) {
                console.error('送信エラー:', error);
                document.querySelector('.loading').style.display = 'none';
                document.querySelector('.error-message').style.display = 'block';
                document.getElementById('errorText').textContent = `送信に失敗しました: ${error.message}`;
                document.querySelector('button[type="submit"]').style.display = 'flex';
            }
        });

        // 初期化
        updateRemoveButtons();
    </script>
<script defer="" src="./都合の悪い日 提出フォーム（日付別備考対応版）_files/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon="{&quot;rayId&quot;:&quot;96e787557fb69650&quot;,&quot;serverTiming&quot;:{&quot;name&quot;:{&quot;cfExtPri&quot;:true,&quot;cfEdge&quot;:true,&quot;cfOrigin&quot;:true,&quot;cfL4&quot;:true,&quot;cfSpeedBrain&quot;:true,&quot;cfCacheStatus&quot;:true}},&quot;version&quot;:&quot;2025.7.0&quot;,&quot;token&quot;:&quot;4edd5f8ec12a48cfa682ab8261b80a79&quot;}" crossorigin="anonymous"></script>


    <script id="html_badge_script1">
        window.__genspark_remove_badge_link = "https://www.genspark.ai/api/html_badge/" +
            "remove_badge?token=To%2FBnjzloZ3UfQdcSaYfDtrWEX4wJD2svB9ASNeRIrgNhT9l%2B7l3ChSMl5svg3jI5j5KrL3mkxxdGwBXbnhex9oPPbBb3NMUGEA7X7ulXJyPYBf2YOhDULRvhTtSn9FVmFwbVZudn%2FQOZgRFG5BgN0xO452lacoGhc%2Fd2GuZzXD8K2qAcAF6zS1MOaKtS4gnfYASTLlQVzD%2FF8VjTLd%2BXQTc0v%2BVSetqxOAJyJciVzFfcRWBcrwe9irS5J4uvHxcx4yne%2Bsg5UtpmiG2oaseYqZGd%2FZHDNU7D%2BiUwkUWFx0msjGI6tcoGX2v93AJsGMJ8M%2FC2JLyq2Prw0h1aK6A68GFTMenohlqc7%2BIQ8bnwi7zW0IbT3tRcR4woUapuTi3f6IR6HiiV9haVKa0sUaYOf5hU%2F9FpxuefjYGaVkvzX8Rsowi%2BONZNPnB6injdFPypFoai3Dw1e62KOcQvpAw98BfuH0qi7XLCA%2FxcUnLoymXQvnZ4CrU4YqXUl2DsZc8abiJanu8FxQLmaJ4XIyd6Gx3xyX1MYYr5NJmvtGUAwg%3D";
        window.__genspark_locale = "ja-JP";
        window.__genspark_token = "To/BnjzloZ3UfQdcSaYfDtrWEX4wJD2svB9ASNeRIrgNhT9l+7l3ChSMl5svg3jI5j5KrL3mkxxdGwBXbnhex9oPPbBb3NMUGEA7X7ulXJyPYBf2YOhDULRvhTtSn9FVmFwbVZudn/QOZgRFG5BgN0xO452lacoGhc/d2GuZzXD8K2qAcAF6zS1MOaKtS4gnfYASTLlQVzD/F8VjTLd+XQTc0v+VSetqxOAJyJciVzFfcRWBcrwe9irS5J4uvHxcx4yne+sg5UtpmiG2oaseYqZGd/ZHDNU7D+iUwkUWFx0msjGI6tcoGX2v93AJsGMJ8M/C2JLyq2Prw0h1aK6A68GFTMenohlqc7+IQ8bnwi7zW0IbT3tRcR4woUapuTi3f6IR6HiiV9haVKa0sUaYOf5hU/9FpxuefjYGaVkvzX8Rsowi+ONZNPnB6injdFPypFoai3Dw1e62KOcQvpAw98BfuH0qi7XLCA/xcUnLoymXQvnZ4CrU4YqXUl2DsZc8abiJanu8FxQLmaJ4XIyd6Gx3xyX1MYYr5NJmvtGUAwg=";
    </script>
    
    <script id="html_notice_dialog_script" src="./都合の悪い日 提出フォーム（日付別備考対応版）_files/notice_dialog.js"></script>
    </body></html>