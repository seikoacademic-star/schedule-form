<!DOCTYPE html>
<!-- saved from url=(0127)https://gensparkpublicblob.blob.core.windows.net/user-upload-image/page/tooluse_RXGWHZAxSFW9dZ5bFCSRhA/seiko_fullname_form.html -->
<html lang="ja"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>éƒ½åˆã®æ‚ªã„æ—¥ æå‡ºãƒ»ç¢ºèªãƒ•ã‚©ãƒ¼ãƒ </title>
    <link href="./0827form_files/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="./0827form_files/all.min.css">
    <style>
        :root {
            --primary-red: #c41e3a;
            --light-red: #e8586a;
            --primary-grey: #f5f5f5;
            --dark-grey: #666666;
            --text-black: #333333;
        }

        body {
            font-family: 'Hiragino Kaku Gothic Pro', 'ãƒ’ãƒ©ã‚®ãƒè§’ã‚´ Pro W3', Meiryo, ãƒ¡ã‚¤ãƒªã‚ª, Osaka, 'MS PGothic', arial, helvetica, sans-serif;
            background: linear-gradient(135deg, var(--primary-grey) 0%, #ffffff 100%);
            min-height: 100vh;
        }

        .main-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header-section {
            background: linear-gradient(135deg, var(--primary-red) 0%, var(--light-red) 100%);
            padding: 20px;
            text-align: center;
            color: white;
        }

        .section-divider {
            border-top: 3px solid var(--primary-red);
            margin: 30px 0;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: var(--text-black);
        }

        .form-input, .form-select, .form-textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

        .form-input:focus, .form-select:focus, .form-textarea:focus {
            outline: none;
            border-color: var(--primary-red);
            box-shadow: 0 0 0 3px rgba(196, 30, 58, 0.1);
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-red) 0%, var(--light-red) 100%);
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(196, 30, 58, 0.3);
        }

        .btn-secondary {
            background: var(--dark-grey);
            color: white;
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            transition: background-color 0.3s ease;
        }

        .btn-secondary:hover {
            background: #555555;
        }

        .btn-add {
            background: var(--primary-grey);
            color: var(--text-black);
            border: 2px solid var(--primary-red);
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .btn-add:hover {
            background: var(--primary-red);
            color: white;
        }

        .schedule-item {
            background: #f8f9fa;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 15px;
            position: relative;
        }

        .schedule-item h4 {
            color: var(--primary-red);
            margin-bottom: 15px;
            font-size: 16px;
            font-weight: bold;
        }

        .delete-schedule {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #dc3545;
            color: white;
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            cursor: pointer;
            font-size: 12px;
        }

        .time-selection {
            display: none;
            margin-top: 15px;
            padding: 15px;
            background: white;
            border-radius: 6px;
            border: 1px solid #e0e0e0;
        }

        .time-selection.show {
            display: block;
        }

        .radio-group {
            display: flex;
            gap: 20px;
            margin: 10px 0;
        }

        .radio-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .guidance-box {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 20px;
            font-size: 13px;
            color: #856404;
        }

        .report-item {
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .report-details {
            flex: 1;
        }

        .report-date {
            font-weight: bold;
            color: var(--primary-red);
        }

        .report-info {
            font-size: 13px;
            color: var(--dark-grey);
            margin-top: 5px;
        }

        .loading-spinner {
            display: none;
            text-align: center;
            color: var(--primary-red);
        }

        .error-message {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            border-radius: 6px;
            padding: 10px;
            color: #721c24;
            font-size: 13px;
            margin-bottom: 15px;
        }

        .success-message {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            border-radius: 6px;
            padding: 10px;
            color: #155724;
            font-size: 13px;
            margin-bottom: 15px;
        }

        @media (max-width: 768px) {
            .main-container {
                margin: 10px;
                border-radius: 8px;
            }
            
            .radio-group {
                flex-direction: column;
                gap: 10px;
            }
        }
    </style>
<style>
    .genspark-notice-dialog {
      display: flex;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      z-index: 10001;
      align-items: center;
      justify-content: center;
    }

    .genspark-notice-content {
      background-color: white;
      border-radius: 8px;
      max-width: 600px;
      width: 90%;
      box-sizing: border-box;
      padding: 10px 30px 30px 30px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      font-size: 16px;
    }

    .genspark-notice-title {
      color: #000;
      font-family: Arial;
      font-size: 20px;
      font-style: normal;
      font-weight: 700;
      line-height: 150%; 
    }

    .genspark-notice-list {
      margin: 24px 0;
      
      color: #606366;
      font-family: Arial;
      font-size: 14px;
      font-style: normal;
      font-weight: 400;
      line-height: 150%;
      padding-left: 12px;
    }

    .genspark-notice-list li {
      margin-bottom: 12px;
      list-style-type: disc;
    }

    .genspark-notice-list li a {
      color: #606366;
      text-decoration: underline;
    }

    .genspark-notice-checkbox {
      display: flex;
      align-items: center;
      margin-top: 20px;
      gap: 10px;

      color: #232425;

      font-family: Arial;
      font-size: 14px;
      font-style: normal;
      font-weight: 400;
      line-height: normal;
    }

    .genspark-notice-actions {
      display: flex;
      justify-content: center;
      margin-top: 20px;
    }
      
    .genspark-notice-ok {
      color: #232425;

      text-align: center;
      font-family: Arial;
      font-size: 16px;
      font-style: normal;
      font-weight: 700;
      line-height: 150%; 

      cursor: pointer;
      display: flex;
      height: 40px;
      padding: 6px 14px;
      justify-content: center;
      align-items: center;
      gap: 10px;
      align-self: stretch;
      border-radius: 8px;
      border: 1px solid #000;
      box-sizing: border-box;
      width: 100%;
    }
  </style></head>
<body class="bg-gray-50 py-8">
    <div class="main-container">
        <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <div class="header-section">
            <h1 class="text-2xl font-bold mb-2">
                <i class="fas fa-calendar-times mr-2"></i>
                éƒ½åˆã®æ‚ªã„æ—¥ æå‡ºãƒ»ç¢ºèªãƒ•ã‚©ãƒ¼ãƒ 
            </h1>
            <p class="text-sm opacity-90">è¤‡æ•°ã®æ—¥ç¨‹ã‚’ä¸€åº¦ã«å ±å‘Šã§ãã¾ã™ã€‚å„æ—¥ç¨‹ã”ã¨ã«å‚™è€ƒã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚</p>
        </div>

        <div class="p-6">
            <!-- å ±å‘Šå±¥æ­´ç¢ºèªã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
            <div class="mb-8">
                <h2 class="text-xl font-bold mb-4 text-gray-800">
                    <i class="fas fa-search mr-2 text-red-600"></i>
                    éå»ã®å ±å‘Šã‚’ç¢ºèª
                </h2>
                
                <div class="guidance-box">
                    <i class="fas fa-info-circle mr-2"></i>
                    <strong>å…¥åŠ›ã‚¬ã‚¤ãƒ€ãƒ³ã‚¹ï¼š</strong> å§“åã‚’ç¶šã‘ã¦å…¥åŠ›ã—ã¦ãã ã•ã„ï¼ˆä¾‹ï¼šå±±ç”°å¤ªéƒã€ä½è—¤èŠ±å­ï¼‰ã€‚åŒå§“ã®æ–¹ã‚’åŒºåˆ¥ã™ã‚‹ãŸã‚ã€ãƒ•ãƒ«ãƒãƒ¼ãƒ ã§ã®å…¥åŠ›ãŒå¿…è¦ã§ã™ã€‚
                </div>

                <div class="form-group">
                    <label class="form-label" for="checkName">
                        <i class="fas fa-user mr-2"></i>ã‚ãªãŸã®ãŠåå‰ï¼ˆå§“åï¼‰
                    </label>
                    <input type="text" id="checkName" class="form-input" placeholder="ä¾‹ï¼šå±±ç”°å¤ªéƒï¼ˆå§“åã‚’ç¶šã‘ã¦å…¥åŠ›ï¼‰" autocomplete="name">
                </div>

                <button type="button" class="btn-primary" onclick="checkReports()">
                    <i class="fas fa-search mr-2"></i>ç¢ºèªã™ã‚‹
                </button>

                <div id="loadingCheck" class="loading-spinner mt-4">
                    <i class="fas fa-spinner fa-spin mr-2"></i>ç¢ºèªä¸­...
                </div>

                <div id="checkResult" class="mt-4"></div>
            </div>

            <div class="section-divider"></div>

            <!-- æ–°è¦å ±å‘Šã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
            <div>
                <h2 class="text-xl font-bold mb-4 text-gray-800">
                    <i class="fas fa-plus-circle mr-2 text-red-600"></i>
                    æ–°ã—ã„éƒ½åˆã®æ‚ªã„æ—¥ã‚’å ±å‘Š
                </h2>

                <form id="scheduleForm">
                    <div class="form-group">
                        <label class="form-label" for="submitterName">
                            <i class="fas fa-user mr-2"></i>æå‡ºè€…å
                        </label>
                        <div class="guidance-box">
                            å§“åã‚’ç¶šã‘ã¦å…¥åŠ›ã—ã¦ãã ã•ã„ï¼ˆä¾‹ï¼šç”°ä¸­å¤ªéƒï¼‰ã€‚åŒå§“ã®æ–¹ã¨ã®åŒºåˆ¥ã®ãŸã‚ã€å¿…ãšãƒ•ãƒ«ãƒãƒ¼ãƒ ã§ã”å…¥åŠ›ãã ã•ã„ã€‚
                        </div>
                        <input type="text" id="submitterName" class="form-input" placeholder="ä¾‹ï¼šç”°ä¸­å¤ªéƒï¼ˆå§“åã‚’ç¶šã‘ã¦å…¥åŠ›ï¼‰" required="" autocomplete="name">
                    </div>

                    <h3 class="text-lg font-bold mb-4 text-gray-800">
                        <i class="fas fa-calendar-alt mr-2"></i>éƒ½åˆã®æ‚ªã„æ—¥ç¨‹
                    </h3>

                    <button type="button" class="btn-add mb-4" onclick="addSchedule()">
                        <i class="fas fa-plus mr-2"></i>æ—¥ç¨‹ã‚’è¿½åŠ 
                    </button>

                    <div id="scheduleContainer">
                        <!-- æ—¥ç¨‹é …ç›®ãŒã“ã“ã«è¿½åŠ ã•ã‚Œã¾ã™ -->
                    <div class="schedule-item" id="schedule-1">
                <button type="button" class="delete-schedule" onclick="removeSchedule(1)" title="ã“ã®æ—¥ç¨‹ã‚’å‰Šé™¤">
                    <i class="fas fa-times"></i>
                </button>
                
                <h4>
                    <i class="fas fa-calendar mr-2"></i>æ—¥ç¨‹ 1
                </h4>
                
                <div class="form-group">
                    <label class="form-label">æ—¥ä»˜</label>
                    <input type="date" class="form-input" name="date-1" required="">
                </div>

                <div class="form-group">
                    <label class="form-label">ã‚¿ã‚¤ãƒ—</label>
                    <div class="radio-group">
                        <div class="radio-item">
                            <input type="radio" id="allday-1" name="type-1" value="çµ‚æ—¥ä¸å¯" onchange="toggleTimeSelection(1)" checked="">
                            <label for="allday-1">çµ‚æ—¥ä¸å¯</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="timespec-1" name="type-1" value="æ™‚é–“å¸¯æŒ‡å®š" onchange="toggleTimeSelection(1)">
                            <label for="timespec-1">æ™‚é–“å¸¯æŒ‡å®š</label>
                        </div>
                    </div>
                </div>

                <div id="timeSelection-1" class="time-selection">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="form-label">é–‹å§‹æ™‚åˆ»</label>
                            <select class="form-select" name="startTime-1">
                                <option value="08:00">08:00</option><option value="08:30">08:30</option><option value="09:00">09:00</option><option value="09:30">09:30</option><option value="10:00">10:00</option><option value="10:30">10:30</option><option value="11:00">11:00</option><option value="11:30">11:30</option><option value="12:00">12:00</option><option value="12:30">12:30</option><option value="13:00">13:00</option><option value="13:30">13:30</option><option value="14:00">14:00</option><option value="14:30">14:30</option><option value="15:00">15:00</option><option value="15:30">15:30</option><option value="16:00">16:00</option><option value="16:30">16:30</option><option value="17:00">17:00</option><option value="17:30">17:30</option><option value="18:00">18:00</option><option value="18:30">18:30</option><option value="19:00">19:00</option><option value="19:30">19:30</option><option value="20:00">20:00</option><option value="20:30">20:30</option><option value="21:00">21:00</option>
                            </select>
                        </div>
                        <div>
                            <label class="form-label">çµ‚äº†æ™‚åˆ»</label>
                            <select class="form-select" name="endTime-1">
                                <option value="08:30">08:30</option><option value="09:00">09:00</option><option value="09:30">09:30</option><option value="10:00">10:00</option><option value="10:30">10:30</option><option value="11:00">11:00</option><option value="11:30">11:30</option><option value="12:00">12:00</option><option value="12:30">12:30</option><option value="13:00">13:00</option><option value="13:30">13:30</option><option value="14:00">14:00</option><option value="14:30">14:30</option><option value="15:00">15:00</option><option value="15:30">15:30</option><option value="16:00">16:00</option><option value="16:30">16:30</option><option value="17:00">17:00</option><option value="17:30">17:30</option><option value="18:00">18:00</option><option value="18:30">18:30</option><option value="19:00">19:00</option><option value="19:30">19:30</option><option value="20:00">20:00</option><option value="20:30">20:30</option><option value="21:00">21:00</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">å‚™è€ƒï¼ˆä»»æ„ï¼‰</label>
                    <textarea class="form-textarea" name="remarks-1" rows="3" placeholder="ã“ã®æ—¥ç¨‹ã«é–¢ã™ã‚‹è£œè¶³äº‹é …ãŒã‚ã‚Œã°å…¥åŠ›ã—ã¦ãã ã•ã„ï¼ˆä¾‹ï¼šä¼šè­°ã®ãŸã‚ã€é€šé™¢ã®ãŸã‚ï¼‰"></textarea>
                </div>
            </div></div>

                    <div id="submitSection" style="display: block;" class="mt-6">
                        <button type="submit" class="btn-primary w-full">
                            <i class="fas fa-paper-plane mr-2"></i>é€ä¿¡
                        </button>
                    </div>

                    <div id="loadingSubmit" class="loading-spinner mt-4">
                        <i class="fas fa-spinner fa-spin mr-2"></i>é€ä¿¡ä¸­...
                    </div>

                    <div id="submitResult" class="mt-4"></div>
                </form>
            </div>
        </div>
    </div>

    <script>
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzbSiSIQwGvs01hEYc-DWr9PhgTT2vJfDT559EvgblEEbBqwfzPk2MB2OAPnxelOUY/exec';
        let scheduleCount = 0;

        // æ™‚é–“é¸æŠè‚¢ã‚’ç”Ÿæˆ
        function generateTimeOptions() {
            const options = [];
            for (let hour = 8; hour <= 21; hour++) {
                for (let minute of [0, 30]) {
                    if (hour === 21 && minute === 30) break;
                    const timeStr = `${hour.toString().padStart(2, '0')}:${minute.toString().padStart(2, '0')}`;
                    options.push(timeStr);
                }
            }
            return options;
        }

        // æ—¥ç¨‹ã‚’è¿½åŠ 
        function addSchedule() {
            scheduleCount++;
            const container = document.getElementById('scheduleContainer');
            const timeOptions = generateTimeOptions();
            
            const scheduleDiv = document.createElement('div');
            scheduleDiv.className = 'schedule-item';
            scheduleDiv.id = `schedule-${scheduleCount}`;
            
            scheduleDiv.innerHTML = `
                <button type="button" class="delete-schedule" onclick="removeSchedule(${scheduleCount})" title="ã“ã®æ—¥ç¨‹ã‚’å‰Šé™¤">
                    <i class="fas fa-times"></i>
                </button>
                
                <h4>
                    <i class="fas fa-calendar mr-2"></i>æ—¥ç¨‹ ${scheduleCount}
                </h4>
                
                <div class="form-group">
                    <label class="form-label">æ—¥ä»˜</label>
                    <input type="date" class="form-input" name="date-${scheduleCount}" required>
                </div>

                <div class="form-group">
                    <label class="form-label">ã‚¿ã‚¤ãƒ—</label>
                    <div class="radio-group">
                        <div class="radio-item">
                            <input type="radio" id="allday-${scheduleCount}" name="type-${scheduleCount}" value="çµ‚æ—¥ä¸å¯" 
                                   onchange="toggleTimeSelection(${scheduleCount})" checked>
                            <label for="allday-${scheduleCount}">çµ‚æ—¥ä¸å¯</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="timespec-${scheduleCount}" name="type-${scheduleCount}" value="æ™‚é–“å¸¯æŒ‡å®š"
                                   onchange="toggleTimeSelection(${scheduleCount})">
                            <label for="timespec-${scheduleCount}">æ™‚é–“å¸¯æŒ‡å®š</label>
                        </div>
                    </div>
                </div>

                <div id="timeSelection-${scheduleCount}" class="time-selection">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="form-label">é–‹å§‹æ™‚åˆ»</label>
                            <select class="form-select" name="startTime-${scheduleCount}">
                                ${timeOptions.map(time => `<option value="${time}">${time}</option>`).join('')}
                            </select>
                        </div>
                        <div>
                            <label class="form-label">çµ‚äº†æ™‚åˆ»</label>
                            <select class="form-select" name="endTime-${scheduleCount}">
                                ${timeOptions.slice(1).map(time => `<option value="${time}">${time}</option>`).join('')}
                            </select>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">å‚™è€ƒï¼ˆä»»æ„ï¼‰</label>
                    <textarea class="form-textarea" name="remarks-${scheduleCount}" rows="3" 
                              placeholder="ã“ã®æ—¥ç¨‹ã«é–¢ã™ã‚‹è£œè¶³äº‹é …ãŒã‚ã‚Œã°å…¥åŠ›ã—ã¦ãã ã•ã„ï¼ˆä¾‹ï¼šä¼šè­°ã®ãŸã‚ã€é€šé™¢ã®ãŸã‚ï¼‰"></textarea>
                </div>
            `;
            
            container.appendChild(scheduleDiv);
            document.getElementById('submitSection').style.display = 'block';
        }

        // æ—¥ç¨‹ã‚’å‰Šé™¤
        function removeSchedule(id) {
            const scheduleDiv = document.getElementById(`schedule-${id}`);
            if (scheduleDiv) {
                scheduleDiv.remove();
            }
            
            // æ®‹ã‚Šã®æ—¥ç¨‹ãŒãªã„å ´åˆã¯é€ä¿¡ãƒœã‚¿ãƒ³ã‚’éè¡¨ç¤º
            const remaining = document.querySelectorAll('.schedule-item').length;
            if (remaining === 0) {
                document.getElementById('submitSection').style.display = 'none';
            }
        }

        // æ™‚é–“é¸æŠã®è¡¨ç¤ºåˆ‡ã‚Šæ›¿ãˆ
        function toggleTimeSelection(id) {
            const timeSpecRadio = document.getElementById(`timespec-${id}`);
            const timeSelection = document.getElementById(`timeSelection-${id}`);
            
            if (timeSpecRadio.checked) {
                timeSelection.classList.add('show');
            } else {
                timeSelection.classList.remove('show');
            }
        }

        // å ±å‘Šå±¥æ­´ç¢ºèª
        async function checkReports() {
            const name = document.getElementById('checkName').value.trim();
            const resultDiv = document.getElementById('checkResult');
            const loading = document.getElementById('loadingCheck');
            
            if (!name) {
                resultDiv.innerHTML = '<div class="error-message">ãŠåå‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚</div>';
                return;
            }

            loading.style.display = 'block';
            resultDiv.innerHTML = '';

            try {
                const response = await fetch(`${SCRIPT_URL}?action=getReports&name=${encodeURIComponent(name)}`);
                const data = await response.json();
                
                loading.style.display = 'none';

                if (data.result === 'success') {
                    if (data.reports && data.reports.length > 0) {
                        let html = `
                            <h3 class="text-lg font-bold mb-3 text-gray-800">
                                <i class="fas fa-list mr-2"></i>ã€Œ${name}ã€ã•ã‚“ã®å ±å‘Šä¸€è¦§
                            </h3>
                        `;
                        
                        data.reports.forEach((report, index) => {
                            const timeDetail = report.type === 'æ™‚é–“å¸¯æŒ‡å®š' ? report.timeDetail : 'çµ‚æ—¥';
                            html += `
                                <div class="report-item">
                                    <div class="report-details">
                                        <div class="report-date">ğŸ“… ${report.date}</div>
                                        <div class="report-info">
                                            <span class="mr-4">â° ${report.type} (${timeDetail})</span>
                                            ${report.remarks ? `ğŸ’¬ ${report.remarks}` : ''}
                                        </div>
                                        <div class="report-info text-xs">
                                            ğŸ“ å ±å‘Šæ—¥æ™‚: ${report.timestamp}
                                        </div>
                                    </div>
                                    <button class="btn-secondary" onclick="requestDelete('${report.date}', '${name}')">
                                        <i class="fas fa-trash mr-1"></i>å‰Šé™¤ä¾é ¼
                                    </button>
                                </div>
                            `;
                        });
                        
                        resultDiv.innerHTML = html;
                    } else {
                        resultDiv.innerHTML = `
                            <div class="text-center py-8 text-gray-500">
                                <i class="fas fa-inbox text-4xl mb-4"></i>
                                <p>ã€Œ${name}ã€ã•ã‚“ã®å ±å‘Šã¯ã¾ã ã‚ã‚Šã¾ã›ã‚“ã€‚</p>
                            </div>
                        `;
                    }
                } else {
                    resultDiv.innerHTML = `<div class="error-message">ã‚¨ãƒ©ãƒ¼: ${data.message}</div>`;
                }
            } catch (error) {
                loading.style.display = 'none';
                resultDiv.innerHTML = `<div class="error-message">é€šä¿¡ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ${error.message}</div>`;
            }
        }

        // å‰Šé™¤ä¾é ¼
        function requestDelete(date, name) {
            if (confirm(`${date}ã®å ±å‘Šã‚’å‰Šé™¤ä¾é ¼ã—ã¾ã™ã‹ï¼Ÿ\nç®¡ç†è€…ã«å‰Šé™¤ä¾é ¼ãŒé€ä¿¡ã•ã‚Œã¾ã™ã€‚`)) {
                // å‰Šé™¤ä¾é ¼ã®å‡¦ç†ï¼ˆå®Ÿè£…ã¯ç®¡ç†è€…ã®é‹ç”¨æ–¹æ³•ã«å¿œã˜ã¦ï¼‰
                alert('å‰Šé™¤ä¾é ¼ã‚’é€ä¿¡ã—ã¾ã—ãŸã€‚ç®¡ç†è€…ãŒç¢ºèªæ¬¡ç¬¬ã€è©²å½“ã®å ±å‘ŠãŒå‰Šé™¤ã•ã‚Œã¾ã™ã€‚');
            }
        }

        // ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡
        document.getElementById('scheduleForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const submitterName = document.getElementById('submitterName').value.trim();
            const scheduleItems = document.querySelectorAll('.schedule-item');
            const loading = document.getElementById('loadingSubmit');
            const resultDiv = document.getElementById('submitResult');
            
            if (!submitterName) {
                resultDiv.innerHTML = '<div class="error-message">æå‡ºè€…åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚</div>';
                return;
            }
            
            if (scheduleItems.length === 0) {
                resultDiv.innerHTML = '<div class="error-message">å°‘ãªãã¨ã‚‚1ã¤ã®æ—¥ç¨‹ã‚’è¿½åŠ ã—ã¦ãã ã•ã„ã€‚</div>';
                return;
            }

            loading.style.display = 'block';
            resultDiv.innerHTML = '';

            const schedules = [];
            let hasError = false;

            scheduleItems.forEach((item) => {
                const id = item.id.split('-')[1];
                const date = document.querySelector(`input[name="date-${id}"]`).value;
                const typeRadio = document.querySelector(`input[name="type-${id}"]:checked`);
                const remarks = document.querySelector(`textarea[name="remarks-${id}"]`).value;
                
                if (!date || !typeRadio) {
                    hasError = true;
                    return;
                }
                
                let timeDetail = '';
                if (typeRadio.value === 'æ™‚é–“å¸¯æŒ‡å®š') {
                    const startTime = document.querySelector(`select[name="startTime-${id}"]`).value;
                    const endTime = document.querySelector(`select[name="endTime-${id}"]`).value;
                    timeDetail = `${startTime} ã€œ ${endTime}`;
                } else {
                    timeDetail = 'çµ‚æ—¥ä¸å¯';
                }
                
                schedules.push({
                    name: submitterName,
                    date: date,
                    type: typeRadio.value,
                    timeDetail: timeDetail,
                    remarks: remarks || ''
                });
            });

            if (hasError) {
                loading.style.display = 'none';
                resultDiv.innerHTML = '<div class="error-message">ã™ã¹ã¦ã®å¿…é ˆé …ç›®ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚</div>';
                return;
            }

            // å„ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’å€‹åˆ¥ã«é€ä¿¡
            let successCount = 0;
            let errorCount = 0;

            for (const schedule of schedules) {
                try {
                    const formData = new FormData();
                    formData.append('name', schedule.name);
                    formData.append('date', schedule.date);
                    formData.append('type', schedule.type);
                    formData.append('timeDetail', schedule.timeDetail);
                    formData.append('remarks', schedule.remarks);

                    const response = await fetch(SCRIPT_URL, {
                        method: 'POST',
                        body: formData
                    });

                    const data = await response.json();
                    if (data.result === 'success') {
                        successCount++;
                    } else {
                        errorCount++;
                    }
                } catch (error) {
                    errorCount++;
                }
            }

            loading.style.display = 'none';

            if (errorCount === 0) {
                resultDiv.innerHTML = `
                    <div class="success-message">
                        <i class="fas fa-check-circle mr-2"></i>
                        ${successCount}ä»¶ã®æ—¥ç¨‹ãŒæ­£å¸¸ã«é€ä¿¡ã•ã‚Œã¾ã—ãŸã€‚
                    </div>
                `;
                // ãƒ•ã‚©ãƒ¼ãƒ ãƒªã‚»ãƒƒãƒˆ
                document.getElementById('scheduleForm').reset();
                document.getElementById('scheduleContainer').innerHTML = '';
                document.getElementById('submitSection').style.display = 'none';
                scheduleCount = 0;
            } else {
                resultDiv.innerHTML = `
                    <div class="error-message">
                        <i class="fas fa-exclamation-triangle mr-2"></i>
                        é€ä¿¡ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚æˆåŠŸ: ${successCount}ä»¶ã€å¤±æ•—: ${errorCount}ä»¶
                    </div>
                `;
            }
        });

        // åˆæœŸåŒ–ï¼šæœ€åˆã®æ—¥ç¨‹ã‚’è¿½åŠ 
        document.addEventListener('DOMContentLoaded', function() {
            addSchedule();
        });
    </script>


    <script id="html_badge_script1">
        window.__genspark_remove_badge_link = "https://www.genspark.ai/api/html_badge/" +
            "remove_badge?token=To%2FBnjzloZ3UfQdcSaYfDn11xa75m%2BcjlZNUV0tPKi3Y%2BpZK8UjErTrBuuzwKQVG6lIFd21hsz%2BKJwtq7hVzBGMg3%2BzfaAHH0jmAn64t00p9G1HP%2Fn8Pz%2Fn2s7UN%2B%2BkFVZv7%2BCQugx72pBUk4P4pGGmOrcI0lBdlqE%2BVSuPHWLJ7vPuqOM%2BDrx1OGCeiMWtcDOOqFflTjiegt08OrUwwbH%2FoIQgFNmcf8YsWYYXWvuWYNLyrmWLFM1RSdyHo4GCEoZQpfQMrXQ5WOcJaqVi8ki7ZfzqA8HLw58bkRQ9C7s20%2BFk5xmx6MOErzCbM1WLPm6scdTwWH88vUNDHaH6iUhGQ2PvfpDDnQP4ylAfOo1%2FQCibE4MqnAstiRV0muETMTDGqx2prijK%2Fl%2F0RyhSIQTiiueLdC3ztMNoHI3jofjdX8olcPlhL4zxL1APVkDxMiDGugNdUJOe2Iae5%2B5GYkld05hDOeWewaJ42lxJnIdkpvEUcBoscajicpnIu4WdHe8AwT5J7U1jhQ68bUYrtuA%3D%3D";
        window.__genspark_locale = "ja-JP";
        window.__genspark_token = "To/BnjzloZ3UfQdcSaYfDn11xa75m+cjlZNUV0tPKi3Y+pZK8UjErTrBuuzwKQVG6lIFd21hsz+KJwtq7hVzBGMg3+zfaAHH0jmAn64t00p9G1HP/n8Pz/n2s7UN++kFVZv7+CQugx72pBUk4P4pGGmOrcI0lBdlqE+VSuPHWLJ7vPuqOM+Drx1OGCeiMWtcDOOqFflTjiegt08OrUwwbH/oIQgFNmcf8YsWYYXWvuWYNLyrmWLFM1RSdyHo4GCEoZQpfQMrXQ5WOcJaqVi8ki7ZfzqA8HLw58bkRQ9C7s20+Fk5xmx6MOErzCbM1WLPm6scdTwWH88vUNDHaH6iUhGQ2PvfpDDnQP4ylAfOo1/QCibE4MqnAstiRV0muETMTDGqx2prijK/l/0RyhSIQTiiueLdC3ztMNoHI3jofjdX8olcPlhL4zxL1APVkDxMiDGugNdUJOe2Iae5+5GYkld05hDOeWewaJ42lxJnIdkpvEUcBoscajicpnIu4WdHe8AwT5J7U1jhQ68bUYrtuA==";
    </script>
    
    <script id="html_notice_dialog_script" src="./0827form_files/notice_dialog.js"></script>
    </body></html>